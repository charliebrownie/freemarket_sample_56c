= render 'shared/header'
= render 'shared/exhibitation'
.wrapper1
  %section.item-container1
    %h1.item-container1__item-name 
      = @product.name
    .item-container1__item-content.clearfix
      .content--photo
        .content--photo-up
          = image_tag @product.images.first.image, size: "300x300"
    
        .content--photo-down
          - @product.images.each_with_index do |image, index|
            - unless index == 0 
              .boxshow 
                = image_tag image.image, size: "72x72"
          //params[:id]で取得した一つの商品に対する複数枚の写真を並べ出す際に下に複数枚小さく並ぶ箇所にメインの画像とのダブりを解消する記述//
      %table.content--detail-table
        %tbody.table
          %tr.table--section
            %th.table--section-left 出品者
            %th.table--section-right-blue 
              = link_to "#{@product.user.nickname}", users_mypage_path, method: :get,class:"blue"
              = image_tag asset_path('sampleicon.png'), size: "130x25"
          %tr.table--section
            %th.table--section-left カテゴリー
            %th.table--section-right-blue 
              = link_to '#',class:"blue" do
                - parent=@product.category.path_ids[0].to_i
                = @category.find(parent).name
              %br  
              %i.fas.fa-angle-right 
                = link_to '#',class:"blue" do
                  - child=@product.category.path_ids[1].to_i
                  = @category.find(child).name 
              %br 
              %i.fas.fa-angle-right 
                = link_to '#',class:"blue" do
                  - grandchild=@product.category.path_ids[2].to_i
                  = @category.find(grandchild).name
                 
          //params[:id]で取得したidの商品に対してcategory子、孫も表示するために記載//
          %tr.table--section
            %th.table--section-left ブランド
            %th.table--section-right-blue 
              = @product.brand.name
              = link_to '',class: "table--section-right-blue "
          %tr.table--section
            %th.table--section-left 商品状態
            %th.table--section-right 
              = @product.condition.name
          %tr.table--section
            %th.table--section-left 配送料負担
            %th.table--section-right 
              = @product.delivery_fee.name
          %tr.table--section
            %th.table--section-left 配送方法
            %th.table--section-right 
              = @product.shipping_method.name
          %tr.table--section
            %th.table--section-left 配送元
            %th.table--section-right-blue 
              = @product.prefecture_from.name
          %tr.table--section
            %th.table--section-left 配送日目安
            %th.table--section-right
              = @product.shipping_days.name
        //上記　brand,categoryからクリックすると本物のメルカリではcategory show pageに遷移するが今の時点では割愛する//     
    .item-container1__item-price
      .test
        %span.item-container1__item-price-bold  ¥
        = @product.price.to_s(:delimited)
        %span.item-container1__item-price-tax (税込)
        %span.item-container1__item-price-shipping-fee 送料込み
    = link_to " 購入画面に進む", product_purchase_path(@product.id),  class:"item-container1__item-buy-btn"
    .item-container1__item-description 
      %p.item-description-inner
        = @product.detail
        
    .item-container1__item-other-btn.clearfix
      .link_btn_left
        %button.item-other-btn-left 
          %i.fa.fa-heart いいね！
        %button#btn.item-other-btn-left  不適切な商品の勧告
      .link_btn_right
        %i.fa.fa-lock 
        = link_to 'あんしん・あんぜんへの取り組み', root_path, class: 'item-other-btn-right'
  .item-detail-message
    .message-container
      .message-content
        %form.message-form{:action => "https://www.mercari.com/jp/comment/add/", :method => "POST"}
          %input{:name => "__csrf_value", :type => "hidden", :value => "c55239470129d9454965bb6e795b3c51b1a2c574b8adf51df04606f58bd8d41724a694229487bce3caa8a08b5537a8923c9f042e751656ccf095b59342b60d381"}/
          %p 相手のことを考え丁寧なコメントを心がけましょう。不快な言葉遣いなどは利用制限や退会処分となることがあります。
          %input{:name => "item_id", :type => "hidden", :value => "m42713469142"}/
          %input{:name => "redirect_url_key", :type => "hidden", :value => "item_detail"}/
          %textarea.textarea-default{:name => "body", :type => "text", :value => ""}
          %button.message-submit.btn-default.btn-gray{:type => "submit"}
            %span コメントする
  %ul.item-nav.clearfix
    %li.item-nav__link
      = link_to '< Preview product', product_path(@product.id-1), class: 'item-nav__link-prev' unless @product.id <= 1
      = link_to 'Next product >', product_path(@product.id.next), class: 'item-nav__link-next'
 
  .sns
    %ul.sns--icon
      %i.fab.fa-facebook-square
      %i.fab.fa-twitter-square
      %i.fab.fa-line
      %i.fab.fa-pinterest-square
  .item-others
    %section.item-others--seller
      %h2.item-others-seller-name 
        = @product.user.nickname 
        さんのその他の商品
      .item-others--seller_product
        - @product.user.products.each do |product_other|
          - unless product_other.id == @product.id
            .items-box
              .items-box_photo
                -# = image_tag img.image, size: "220x220"
                -# = image_tag product_other.images.first.image, size: "220x220"
                = link_to image_tag("#{product_other.images.first.image}", size: "220x220"), product_path(product_other.id)  
              .items-box_body
                %h3.items-box-name
                  =product_other.name
                .items-box-num
                  .items-box-price ￥
                  =product_other.price.to_s(:delimited, delimiter: ',')
                  .items-box-icon
                    %i.fa.fa-heart
                    1
 
    %section.item-others--product
      %h2.item-others--product__category-name
        =@product.category.name
        その他の商品
      .item-others--product__content
      - @same_category_products.each do |product|
        .items-box
          .items-box_photo= link_to image_tag("#{product.images.first.image}", size: "220x220"), product_path(product.id)
          .items-box_body
            %h3.items-box-name
              = product.name
            .items-box-num
              .items-box-price ￥
              = product.price.to_s(:delimited, delimiter: ',')
              .items-box-icon
                %i.fa.fa-heart
                2
        
= render 'shared/footer'

//下の記述は[不適切な商品の勧告]をクリックした時にmodalを表示させる

#modal.modal
  .modal-content
    .modal-body
      .modal-head.bold 確認
      %h1 不適切な商品を報告しますか？
    .modalbtnbox
      %button#closeBtn.modal-btn.modal-btn-cancel{"data-close" => "modal"} キャンセル
      %button.modal-btn.modal-btn-submit はい

// app/assets/javascript　fileに下記を記述しても反映されないので下記に記載
:javascript
  var btn = document.getElementById('btn');
  var modal = document.getElementById('modal');
  

  btn.addEventListener('click', function() {
    modal.style.display = 'block';
  });

  var closeBtn = document.getElementById('closeBtn');

  closeBtn.addEventListener('click', function() {
    modal.style.display = 'none';
  });